!function(){"use strict";function a(){if(window.Promise)return window.Promise;throw new Error("No Promise library could be detected for this browser.")}var b,c="undefined"!=typeof window;b=c===!0?a():require("promise");var d=function(a){function b(c,d,e){if(e<c.length){var f=this;return new a(function(g,h){setTimeout(function(){var i=!1,j=!1;d.call(f,c[e],e,function(k){if(i===!0)return void h(Error("Resolve cannot be called more than once."));if(j!==!0){i=!0;var l=a.resolve(k);l.then(function(a){j!==!0&&(a===!0?(e++,g(e<c.length?b.call(f,c,d,e):!0)):g(a))}).catch(function(a){j=!0,h(a)})}},function(a){if(j===!0)throw new Error("Reject cannot be called more than once.");j=!0,h(a)}),i===!1&&j===!1&&h(new ReferenceError("promiseEvery was not resolved or rejected."))},0)})}}function c(b,d,e){if(e<b.length){var f=this;return new a(function(g,h){setTimeout(function(){var i=!1,j=!1;d.call(f,b[e],e,function(k){if(i===!0)return void h(Error("Resolve cannot be called more than once."));if(j!==!0){i=!0;var l=a.resolve(k);l.then(function(a){j!==!0&&(a===!1?(e++,g(e<b.length?c.call(f,b,d,e):!1)):g(a===!0?!0:!1))}).catch(function(a){j=!0,h(a)})}},function(a){if(j===!0)throw new Error("Reject cannot be called more than once.");j=!0,h(a)}),i===!1&&j===!1&&h(new ReferenceError("promiseEvery was not resolved or rejected."))},0)})}}function d(c,d){if(!c)throw new ReferenceError("Unspecified array items.");if(!d)throw new ReferenceError("Unspecified item handler method.");return 0===c.length?a.resolve(!0):b.call(this,c,d,0)}function e(b,d){if(!b)throw new ReferenceError("Unspecified array items.");if(!d)throw new ReferenceError("Unspecified item handler method.");return 0===b.length?a.resolve(!1):c.call(this,b,d,0)}function f(b,c){var d=this;if(!b)throw new ReferenceError("Unspecified resolution callback.");return new a(function(a,e){setTimeout(function(){b.call(d,a,e)},c||0)})}function g(a,b){if(!a)throw new ReferenceError("Unspecified source promise.");if(!b)throw new ReferenceError("Unspecified attach array.");return b.forEach(function(b){a=a.then("function"==typeof b?b:function(){return b})}),a}return{attach:g,every:d,later:f,some:e}}(b);c?window.promiseExtras=d:"undefined"!=typeof module&&"undefined"!=typeof module.exports&&(module.exports=d)}(),function(){"use strict";function a(){if(window.Promise)return window.Promise;throw new ReferenceError("Promise library could not be detected for this browser.")}function b(){if(window.promiseExtras)return window.promiseExtras;throw new ReferenceError("Promise-extras library could not be detected for this browser.")}var c,d,e="undefined"!=typeof window;c=e===!0?a():require("promise"),d=e===!0?b():require("promise-extras");var f=function(a,b){function c(){var a,b=[],c=arguments[0];for(a=1;a<arguments.length;a++)b.push(arguments[a]);var d={level:b[0],operation:b[1]};c.push(d)}function d(a,b,d,e){return c(this.queryTrail,this.queryLevel,"$and"),i.call(this,a,b,d,e)}function e(a,b,d,e){return c(this.queryTrail,this.queryLevel,"$or"),i.call(this,a,b,d,e)}function f(a,b,d){var e=this.queryTrail.length;c(this.queryTrail,this.queryLevel,"$not");var f=i.call(this,a,b,!0,d);return this.queryTrail[e].result=f,f}function g(a,b,d,e,f){c(this.queryTrail,this.queryLevel,a);var g=this.config.compareMethods[a];if(void 0===g)return f(new ReferenceError("No compare method was found for: "+a)),!1;var h=b[a],i=g.call(this,e,h);return d&&(i=!i),this.queryTrail[this.queryTrail.length-1].result=i,i}function h(a,b,d,e){c(this.queryTrail,this.queryLevel,b);var f=a[b],g=d[b];if(void 0===g)throw new Error("No operation property was found for: "+b);return i.call(this,a,g,e,f)}function i(a,c,i,j){var k,l,m=this;return void 0===i&&(i=!1),m.queryLevel++,k=Object.keys(c),l="$or"in c,l===!0&&(k=k.filter(function(a){return"$or"!==a})),b.every(k,function(b,e,k,l){var n=!1;c.hasOwnProperty(b)&&("$"===b[0]?(void 0===j&&(j=a),n="$not"===b?f.call(m,a,c.$not,j):"$and"===b?d.call(m,a,c.$and,i,j):g.call(m,b,c,i,j,l)):n=h.call(m,a,b,c,i)),k(n)}).then(function(b){return 0===k.length&&(b=!1),l&&void 0!==c.$or&&b===!1&&(b=e.call(m,a,c.$or,i,j)),b}).then(function(a){return m.queryLevel--,a})}function j(a,b){this.config=a||k,this.queryTrail=[],this.sharedContext=b||{}}var k={compareMethods:{$equals:function(a,b){return a===b},$regexp:function(a,b){return b.test(a)},$left:function(a,b){return a.substring(0,b.length)===b},$right:function(a,b){var c=a.length-b.length;return a.substring(c)===b},$typeof:function(a,b){return typeof a===b},$instanceof:function(a,b){return a instanceof b},$toLowerCase:function(a,b){return a.toLowerCase()===b},$toUpperCase:function(a,b){return a.toUpperCase()===b},$inArray:function(a,b){return-1!==b.indexOf(a)},$has:function(a,b){return b instanceof Array?b.every(function(b){return b in a}):b in a},$queryOne:function(a,b){return i.call(this,a,b,!1)},$queryMany:function(a,c){var d=this;return b.every(a,function(a,b,e){e(i.call(d,a,c,!1))})},$querySome:function(a,c){var d=this;return b.some(a,function(a,b,e){e(i.call(d,a,c,!1))})}}};return j.prototype={QueryRunner:j,config:k,queryTrail:[],some:function(c,d){if(void 0===c)return a.reject(new ReferenceError("Unspecified model array."));if(void 0===d)return a.reject(new ReferenceError("Unspecified query."));var e=this;return e.queryTrail=[],e.queryLevel=0,b.some(c,function(a,b,c){c(i.call(e,a,d,!1))})},one:function(b,c){if(void 0===b)return a.reject(new ReferenceError("Unspecified model."));if(void 0===c)return a.reject(new ReferenceError("Unspecified query."));var d=this;return d.queryTrail=[],d.queryLevel=0,i.call(d,b,c,!1)},many:function(c,d){if(void 0===c)return a.reject(new ReferenceError("Unspecified model array."));if(void 0===d)return a.reject(new ReferenceError("Unspecified query."));var e=this;return e.queryTrail=[],e.queryLevel=0,b.every(c,function(a,b,c){c(i.call(e,a,d,!1))})},filter:function(b,d){if(void 0===b)return a.reject(new ReferenceError("Unspecified model array."));if(void 0===d)return a.reject(new ReferenceError("Unspecified query."));var e=this;this.queryTrail=[],this.queryLevel=0;var f=a.resolve([]);return b.forEach(function(a,b){f=f.then(function(f){return e.queryLevel=0,c(e.queryTrail,b,"$$arrayItem"),i.call(e,a,d,!1).then(function(b){return b===!0&&f.push(a),f})})}),f},extract:function(b,d){if(void 0===b)return a.reject(new ReferenceError("Unspecified model dictionary."));if(void 0===d)return a.reject(new ReferenceError("Unspecified query."));var e=this;this.queryTrail=[],this.queryLevel=0;var f=a.resolve({}),g=Object.keys(b);return g.forEach(function(a,g){f=f.then(function(f){e.queryLevel=0,c(e.queryTrail,g,"$$arrayItem");var h=b[a];return i.call(e,h,d,!1).then(function(b){return b===!0&&(f[a]=h),f})})}),f}},new j}(c,d);"undefined"!=typeof window?window.querify=f:"undefined"!=typeof module&&"undefined"!=typeof module.exports&&(module.exports=f)}();
//# sourceMappingURL=querify.all.min.map